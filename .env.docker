# ==============================================================================
# Docker Compose Environment Variables for Multi-Tenant AgentAPI
# ==============================================================================
# Copy this file to .env and fill in your actual values
# DO NOT commit .env to version control!

# ==============================================================================
# Database Configuration
# ==============================================================================
# For local PostgreSQL (using docker-compose postgres service)
DATABASE_URL=postgresql://agentapi:agentapi@postgres:5432/agentapi?sslmode=disable

# For external database (comment out above and uncomment below)
# DATABASE_URL=postgresql://user:password@external-host:5432/dbname?sslmode=require

# PostgreSQL Configuration (for local postgres service)
POSTGRES_USER=agentapi
POSTGRES_PASSWORD=agentapi
POSTGRES_DB=agentapi
POSTGRES_PORT=5432

# ==============================================================================
# Supabase Configuration
# ==============================================================================
# Required for authentication and data storage
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key-here
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here

# ==============================================================================
# AI Provider API Keys
# ==============================================================================
# Anthropic API Key (required for Claude models)
ANTHROPIC_API_KEY=sk-ant-api03-your-key-here

# Google Vertex AI Configuration (optional, for Vertex AI support)
VERTEX_AI_API_KEY=your-gcp-service-account-key-json
VERTEX_AI_PROJECT_ID=your-gcp-project-id
VERTEX_AI_LOCATION=us-central1

# ==============================================================================
# Google Cloud Platform Configuration
# ==============================================================================
# Optional: For GCP Secret Manager and other GCP services
GCP_PROJECT_ID=your-gcp-project-id
GCP_SECRET_MANAGER_KEY=your-gcp-secret-manager-key

# ==============================================================================
# OAuth Provider Configuration
# ==============================================================================
# GitHub OAuth (optional)
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret

# Google OAuth (optional)
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret

# Azure OAuth (optional)
AZURE_CLIENT_ID=your-azure-client-id
AZURE_CLIENT_SECRET=your-azure-client-secret
AZURE_TENANT_ID=common

# Auth0 OAuth (optional)
AUTH0_CLIENT_ID=your-auth0-client-id
AUTH0_CLIENT_SECRET=your-auth0-client-secret
AUTH0_DOMAIN=your-tenant.auth0.com
AUTH0_AUDIENCE=https://your-api-identifier

# ==============================================================================
# Application Configuration
# ==============================================================================
# Environment: development, staging, production
NODE_ENV=development

# Allowed hosts and origins (comma-separated or * for all)
AGENTAPI_ALLOWED_HOSTS=*
AGENTAPI_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3284

# ==============================================================================
# Redis Configuration
# ==============================================================================
# Upstash Redis (REST and native protocols)
UPSTASH_REDIS_REST_URL=https://neat-sloth-35614.upstash.io
UPSTASH_REDIS_REST_TOKEN=AYseAAIncDFhMDY2ZmJlNWNlYzg0ZWNhYmFlYjRmYjliNmQ2NGUwOXAxMzU2MTQ
UPSTASH_REDIS_URL=rediss://default:AYseAAIncDFhMDY2ZmJlNWNlYzg0ZWNhYmFlYjRmYjliNmQ2NGUwOXAxMzU2MTQ@neat-sloth-35614.upstash.io:6379

# Redis configuration
REDIS_ENABLE=true
REDIS_PROTOCOL=native  # or 'rest' for fallback
REDIS_MAX_POOL_SIZE=10
REDIS_CONNECTION_TIMEOUT=5s

# Rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_BURST_SIZE=10

# Circuit breaker
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_SUCCESS_THRESHOLD=2
CIRCUIT_BREAKER_TIMEOUT=30s

# Session storage
SESSION_STORAGE=redis  # or 'memory'
SESSION_TTL=3600s
SESSION_CLEANUP_INTERVAL=300s

# Token encryption (generate a strong random 32-byte key)
TOKEN_ENCRYPTION_KEY=change-this-to-a-random-32-byte-key-for-production

# Legacy Redis Configuration (for local docker-compose redis service)
# REDIS_URL=redis://redis:6379
# REDIS_PORT=6379
# REDIS_MAX_MEMORY=256mb
# REDIS_LOG_LEVEL=notice

# ==============================================================================
# Logging Configuration
# ==============================================================================
# Log level: debug, info, warn, error
LOG_LEVEL=info

# Log format: json, text
LOG_FORMAT=json

# ==============================================================================
# Volume Paths (for bind mounts)
# ==============================================================================
# Local directories for persistent data
# These will be created automatically if they don't exist
WORKSPACE_DATA_PATH=./data/workspaces
POSTGRES_DATA_PATH=./data/postgres
REDIS_DATA_PATH=./data/redis
NGINX_LOGS_PATH=./logs/nginx

# ==============================================================================
# Network Configuration
# ==============================================================================
# Docker network subnet
NETWORK_SUBNET=172.20.0.0/16

# ==============================================================================
# Development Settings
# ==============================================================================
# Set to true to enable hot-reload and debug mode
DEBUG=false
HOT_RELOAD=false

# ==============================================================================
# Security Settings
# ==============================================================================
# Session secret (generate a strong random string)
SESSION_SECRET=your-session-secret-change-this

# JWT secret (generate a strong random string)
JWT_SECRET=your-jwt-secret-change-this

# CORS settings
CORS_ENABLED=true
CORS_CREDENTIALS=true

# ==============================================================================
# Feature Flags (optional)
# ==============================================================================
# Enable/disable specific features
ENABLE_METRICS=true
ENABLE_TRACING=false
ENABLE_RATE_LIMITING=true
ENABLE_AUDIT_LOGGING=true

# ==============================================================================
# Performance Tuning (optional)
# ==============================================================================
# Max concurrent requests
MAX_CONCURRENT_REQUESTS=100

# Request timeout (seconds)
REQUEST_TIMEOUT=300

# WebSocket timeout (seconds)
WEBSOCKET_TIMEOUT=3600

# ==============================================================================
# Monitoring & Observability (optional)
# ==============================================================================
# Metrics endpoint
METRICS_PORT=9090
METRICS_PATH=/metrics

# Health check endpoint
HEALTH_CHECK_PATH=/health

# Sentry DSN (for error tracking)
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id

# ==============================================================================
# Backup Configuration (optional)
# ==============================================================================
# Backup schedule (cron format)
# BACKUP_SCHEDULE=0 2 * * *

# Backup retention days
# BACKUP_RETENTION_DAYS=7

# Backup storage path
# BACKUP_PATH=./backups
